"use strict";var W=Object.create;var k=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var H=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var Z=(t,e)=>{for(var s in e)k(t,s,{get:e[s],enumerable:!0})},E=(t,e,s,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of G(e))!Y.call(t,n)&&n!==s&&k(t,n,{get:()=>e[n],enumerable:!(o=Q(e,n))||o.enumerable});return t};var g=(t,e,s)=>(s=t!=null?W(H(t)):{},E(e||!t||!t.__esModule?k(s,"default",{value:t,enumerable:!0}):s,t)),X=t=>E(k({},"__esModule",{value:!0}),t);var ne={};Z(ne,{Client:()=>L,ConnectionConfig:()=>S,InitDisplay:()=>_,MESSAGE_TYPE:()=>C,MessageParser:()=>z,delay:()=>f,fetchJson:()=>I,getMessageType:()=>h,getValuesByKeys:()=>p,jsonParse:()=>q,jsonString:()=>d,loop:()=>T,postJson:()=>se,removeKeys:()=>O,timeout:()=>te});module.exports=X(ne);var u=require("@whiskeysockets/baileys"),c=g(require("chalk")),K=g(require("pino"));var b=require("@whiskeysockets/baileys"),P=g(require("pino"));var B={author:"https://github.com/zaadevofc",repository:"https://github.com/zaadevofc/zaileys",package:"https://www.npmjs.com/package/zaileys",version:[2,2413,1]};var N=g(require("node-cache"));function S(t){async function e(s){return t.store?(await t.store.loadMessage(s.remoteJid,s.id))?.message||void 0:b.proto.Message.fromObject({})}return{printQRInTerminal:!t.pairing,defaultQueryTimeoutMs:0,connectTimeoutMs:6e4,keepAliveIntervalMs:1e4,msgRetryCounterCache:new N.default,syncFullHistory:!0,mobile:!1,markOnlineOnConnect:!1,generateHighQualityLinkPreview:!0,browser:["Mac OS","chrome","121.0.6167.159"],version:B.version,logger:(0,P.default)({level:"fatal"}),auth:{creds:t.state.creds,keys:(0,b.makeCacheableSignalKeyStore)(t.state.keys,(0,P.default)().child({level:"silent",stream:"store"}))},getMessage:e,patchMessageBeforeSending:s=>(!!(s.buttonsMessage||s.templateMessage||s.listMessage)&&(s={viewOnceMessage:{message:{messageContextInfo:{deviceListMetadataVersion:2,deviceListMetadata:{}},...s}}}),s)}}var C={text:"text",conversation:"text",imageMessage:"image",contactMessage:"contact",locationMessage:"location",extendedTextMessage:"text",documentMessage:"document",audioMessage:"audio",videoMessage:"video",protocolMessage:"protocol",contactsArrayMessage:"contactsArray",highlyStructuredMessage:"highlyStructured",sendPaymentMessage:"sendPayment",liveLocationMessage:"liveLocation",requestPaymentMessage:"requestPayment",declinePaymentRequestMessage:"declinePaymentRequest",cancelPaymentRequestMessage:"cancelPaymentRequest",templateMessage:"template",stickerMessage:"sticker",groupInviteMessage:"groupInvite",templateButtonReplyMessage:"templateButtonReply",productMessage:"product",deviceSentMessage:"deviceSent",listMessage:"list",viewOnceMessage:"viewOnce",orderMessage:"order",listResponseMessage:"listResponse",ephemeralMessage:"ephemeral",invoiceMessage:"invoice",buttonsMessage:"buttons",buttonsResponseMessage:"buttonsResponse",paymentInviteMessage:"paymentInvite",interactiveMessage:"interactive",reactionMessage:"reaction",stickerSyncRmrMessage:"stickerSyncRmr",interactiveResponseMessage:"interactiveResponse",pollCreationMessage:"pollCreation",pollUpdateMessage:"pollUpdate",keepInChatMessage:"keepInChat",documentWithCaptionMessage:"documentWithCaption",requestPhoneNumberMessage:"requestPhoneNumber",viewOnceMessageV2:"viewOnce",encReactionMessage:"encReaction",editedMessage:"edited",viewOnceMessageV2Extension:"viewOnce",pollCreationMessageV2:"pollCreation",scheduledCallCreationMessage:"scheduledCallCreation",groupMentionedMessage:"groupMentioned",pinInChatMessage:"pinInChat",pollCreationMessageV3:"pollCreation",scheduledCallEditMessage:"scheduledCallEdit",ptvMessage:"ptv",botInvokeMessage:"botInvoke",callLogMesssage:"callLog",encCommentMessage:"encComment",bcallMessage:"bcall",lottieStickerMessage:"lottieSticker",eventMessage:"event",commentMessage:"comment",newsletterAdminInviteMessage:"newsletterAdminInvite",extendedTextMessageWithParentKey:"text",placeholderMessage:"placeholder",encEventUpdateMessage:"encEventUpdate"};function h(t){if(typeof t!="object"||t===null)return[];for(let e of Object.keys(t))if(Object.keys(C).includes(e))return[C[e],e];for(let e of Object.values(t)){let s=h(e);if(s)return s}return[]}function T(t,e){return setInterval(t,e)}function d(t){return JSON.stringify(t??{},null,2)}function q(t){return JSON.parse(d(t))}function te(t,e){return setTimeout(t,e)}async function f(t){return new Promise(e=>setTimeout(e,t))}var I=async(t,e)=>await fetch(t).then(s=>s.json()),se=async(t,e)=>await fetch(t,{body:JSON.stringify(e),method:"POST"}).then(s=>s.json());function p(t,e){let s=[],o=n=>{n!=null&&(Array.isArray(n)?n.forEach(o):typeof n=="object"&&Object.entries(n).forEach(([r,a])=>{e.includes(r)&&s.push(a),o(a)}))};return o(t),s}function O(t,e){let s=o=>{if(o===null||typeof o!="object")return o;if(Array.isArray(o))return o.map(s);let n={};for(let r in o)e.includes(r)||(n[r]=s(o[r]));return n};return s(q(t))}var R=g(require("cfonts")),F=g(require("ora"));var j=require("events"),D=g(require("quick-lru")),J=new D.default({maxSize:9999999999}),M=new j.EventEmitter;var V=g(require("chalk"));function _(t){console.clear(),R.default.say("Zaileys",{font:"block",colors:["white","green"],letterSpacing:1,lineHeight:1,space:!1,maxLength:"0"}),R.default.say("         Love this package? help me with donation:         |               https://ko-fi.com/zaadevofc                 |",{font:"console",colors:["black"],background:"green",letterSpacing:1,space:!1,maxLength:"0"});let e=(0,F.default)();M.on("conn_msg",s=>{e[s[0]](s[1]),s[0]=="succeed"&&(J.set("conn_status",s[0]),M.on("conn_config",o=>{o?.forEach((n,r)=>{console.log(n)}),t.showLogs&&console.log(V.default`{cyan — Realtime Logs =>}\n`)}))}),t.showLogs&&M.on("act_msg",s=>{console.log({data:s})})}function z(t,e){return t.map((o,n)=>{let r=Number(o.key.remoteJid?.split("@")[0]);console.log(d(o));let a=O(o,["contextInfo"]),i=p(o,["quotedMessage"])[0],m=h(a),w=p(a,["conversation","text","caption","contentText","description"])[0],y=h(i),A=p(i,["conversation","text","caption","contentText","description"])[0],x=m[0]!="text"&&p(a,[m[1]]),v=y[0]!="text"&&p(i,[y[1]])[0];return v=y[0]=="viewOnce"?p(v,h(v))[0]:v,e.store?.loadMessage("6289526382389@s.whatsapp.net","81AF2468F3C7DD936D771326004D5930").then(U=>{console.log("orang =>>>>  ",U)}),{chatId:o.key.id,fromMe:o.key.fromMe,pushName:o.pushName,remoteJid:o.key.remoteJid,timestamp:o.messageTimestamp,isAuthor:e.authors.includes(r),isBroadcast:o.broadcast,body:{type:m,text:w,isGroup:d(a).includes("@g.us")??!1,isViewOnce:d(a).includes("viewOnce"),media:p(a,[m[1]])},reply:{type:y[0],text:A,isGroup:d(i).includes("@g.us")??!1,isViewOnce:d(i).includes("viewOnce"),media:v}}})}var $={name:"zaileys",description:"Zaileys - Typescript/Javascript WhatsApp NodeJS API",author:{name:"zaadevofc",email:"zaadevofc@gmail.com",url:"https://github.com/zaadevofc"},version:"0.5.1-dev",license:"MIT",main:"dist/index.js",module:"dist/index.mjs",types:"dist/index.d.ts",homepage:"https://github.com/zaadevofc/zaileys",funding:"https://ko-fi.com/zaadevofc",bugs:{url:"https://github.com/zaadevofc/zaileys/issues"},repository:{url:"git+https://github.com/zaadevofc/zaileys.git"},scripts:{build:"tsup","test:dev":"ts-node-dev src/test",test:"ts-node src/test",prod:"tsup && npm publish"},engines:{node:">=18"},keywords:["zaileys","baileys","whatsapp","bot","node","api"],contributors:["zaadevofc@gmail.com"],dependencies:{"@whiskeysockets/baileys":"^6.7.2",cfonts:"^3.2.0",chalk:"^4.1.2",dayjs:"^1.11.11",events:"^3.3.0","link-preview-js":"^3.0.5","log-update":"^3.4.0","node-cache":"^5.1.2",ora:"^5.4.1",pino:"^7.11.0","qrcode-terminal":"^0.12.0","quick-lru":"^5.1.1"},devDependencies:{"@types/node":"^20.13.0",tsup:"^8.0.2",typescript:"^5.4.5"}};var L=class{pairing;phoneNumber;showLogs;authors;socket=M;store;state;me;constructor({pairing:e,phoneNumber:s,showLogs:o,authors:n}){this.pairing=e??!0,this.phoneNumber=s,this.showLogs=o??!0,this.authors=n??[],this.client()}set saveState(e){this.state=e}async client(){_(this);let e=(0,u.makeInMemoryStore)({logger:(0,K.default)().child({level:"silent",stream:"store"})}),{state:s,saveCreds:o}=await(0,u.useMultiFileAuthState)("session/zaileys");e.readFromFile("session/data.json"),T(async()=>{try{e.writeToFile("session/data.json")}catch{await this.socket.emit("conn_msg",["fail",c.default.yellow("[DETECTED] session folder has been deleted by the user")]),await f(2e3),await this.socket.emit("conn_msg",["fail",c.default.yellow("Please rerun the program...")]),await process.exit()}},1e4),this.state=s,this.store=e;let n=(0,u.makeWASocket)(S(this));if(e.bind(n.ev),this.pairing&&this.phoneNumber&&!s.creds.me&&!n.authState.creds.registered){this.socket.emit("conn_msg",["start","Initialization new session..."]),await f(2e3),this.socket.emit("conn_msg",["start","Creating new pairing code..."]),await f(6e3);let a=await n.requestPairingCode(this.phoneNumber.toString());this.socket.emit("conn_msg",["info",`Connect with pairing code : ${c.default.green(a)}`])}n.ev.on("messages.upsert",async a=>{this.socket.emit("act_message",a.messages)});let r=await I("https://registry.npmjs.org/-/package/zaileys/dist-tags");return n.ev.process(async a=>{if(a["creds.update"]){let i=a["creds.update"];i&&r&&this.socket.emit("conn_config",[c.default`{greenBright → Login as       :} {redBright ${i.me?.verifiedName||i.me?.name}}`,c.default`{greenBright → Login Method   :} {cyanBright ${i.pairingCode?"Pairing Code":"QR Code"}}`,c.default`{greenBright → Login Platform :} {cyanBright ${i.platform}}`,c.default`{greenBright → Creds Phone    :} {magentaBright ${i.phoneId}}`,c.default`{greenBright → Creds Device   :} {magentaBright ${i.deviceId}}`,c.default`{greenBright → Libs Current   :} {yellowBright zaileys-${$.version}}`,c.default`{greenBright → Libs Latest    :} {yellowBright zaileys-${r?.latest}}`,""]),await o()}if(a["connection.update"]){let i=a["connection.update"],{connection:m,lastDisconnect:w,qr:y}=i;if(m=="connecting"&&(this.socket.emit("act_connection","connecting"),this.socket.emit("conn_msg",["start","Connecting to server..."])),y&&this.socket.emit("conn_msg",["warn","Please scan the QR code..."]),m==="close"){this.socket.emit("act_connection","close");let x=w?.error?.output.statusCode!==u.DisconnectReason.loggedOut;if(x&&(this.socket.emit("conn_msg",["warn","Failed to connect. Waiting for reconnect..."]),this.client()),!x){this.socket.emit("conn_msg",["fail","Failed to connect. Please delete session and try again."]);return}await this.socket.emit("conn_msg",["info","Trying to reconnect..."]),await f(2e3),await this.socket.emit("conn_msg",["clear"])}m==="open"&&(this.socket.emit("act_connection","ready"),this.socket.emit("conn_msg",["succeed","Connected to server"]),console.log())}}),n}on(e,s){let o=(n,r)=>this.socket.on(`act_${n}`,r);switch(e){case"connection":o(e,n=>s(n));break;case"message":o(e,async n=>s(z(n,this)));break;default:break}}};0&&(module.exports={Client,ConnectionConfig,InitDisplay,MESSAGE_TYPE,MessageParser,delay,fetchJson,getMessageType,getValuesByKeys,jsonParse,jsonString,loop,postJson,removeKeys,timeout});
