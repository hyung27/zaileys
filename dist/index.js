"use strict";var G=Object.create;var b=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty;var ee=(e,t)=>{for(var s in t)b(e,s,{get:t[s],enumerable:!0})},q=(e,t,s,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Y(t))!X.call(e,n)&&n!==s&&b(e,n,{get:()=>t[n],enumerable:!(o=H(t,n))||o.enumerable});return e};var h=(e,t,s)=>(s=e!=null?G(Z(e)):{},q(t||!e||!e.__esModule?b(s,"default",{value:e,enumerable:!0}):s,e)),te=e=>q(b({},"__esModule",{value:!0}),e);var ie={};ee(ie,{Client:()=>N,ConnectionConfig:()=>L,InitDisplay:()=>B,MESSAGE_TYPE:()=>z,MessageParser:()=>E,delay:()=>v,fetchJson:()=>O,getMessageType:()=>y,getValuesByKeys:()=>c,jsonParse:()=>x,jsonString:()=>d,loop:()=>I,postJson:()=>ne,removeKeys:()=>R,timeout:()=>oe});module.exports=te(ie);var m=require("@whiskeysockets/baileys"),p=h(require("chalk")),U=h(require("pino"));var P=require("@whiskeysockets/baileys"),_=h(require("pino"));var J={author:"https://github.com/zaadevofc",repository:"https://github.com/zaadevofc/zaileys",package:"https://www.npmjs.com/package/zaileys",version:[2,2413,1]};var K=h(require("node-cache"));function I(e,t){return setInterval(e,t)}function d(e){return JSON.stringify(e??{},null,2)}function x(e){return JSON.parse(d(e))}function oe(e,t){return setTimeout(e,t)}async function v(e){return new Promise(t=>setTimeout(t,e))}var O=async(e,t)=>await fetch(e).then(s=>s.json()),ne=async(e,t)=>await fetch(e,{body:JSON.stringify(t),method:"POST"}).then(s=>s.json());function c(e,t){let s=[],o=n=>{n!=null&&(Array.isArray(n)?n.forEach(o):typeof n=="object"&&Object.entries(n).forEach(([a,i])=>{t.includes(a)&&s.push(i),o(i)}))};return o(e),s}function R(e,t){let s=o=>{if(o===null||typeof o!="object")return o;if(Array.isArray(o))return o.map(s);let n={};for(let a in o)t.includes(a)||(n[a]=s(o[a]));return n};return s(x(e))}function L(e){async function t(s){return e.store?(await e.store.loadMessage(s.remoteJid,s.id))?.message||void 0:P.proto.Message.fromObject({})}return{printQRInTerminal:!e.pairing,defaultQueryTimeoutMs:0,connectTimeoutMs:6e4,keepAliveIntervalMs:1e4,msgRetryCounterCache:new K.default,syncFullHistory:!0,mobile:!1,markOnlineOnConnect:!1,generateHighQualityLinkPreview:!0,browser:["Mac OS","chrome","121.0.6167.159"],version:J.version,logger:(0,_.default)({level:"fatal"}),auth:{creds:e.state.creds,keys:(0,P.makeCacheableSignalKeyStore)(e.state.keys,(0,_.default)().child({level:"silent",stream:"store"}))},getMessage:t,patchMessageBeforeSending:s=>(!!(s.buttonsMessage||s.templateMessage||s.listMessage)&&(s={viewOnceMessage:{message:{messageContextInfo:{deviceListMetadataVersion:2,deviceListMetadata:{}},...s}}}),s)}}var z={text:"text",conversation:"text",imageMessage:"image",contactMessage:"contact",locationMessage:"location",extendedTextMessage:"text",documentMessage:"document",audioMessage:"audio",videoMessage:"video",protocolMessage:"protocol",contactsArrayMessage:"contactsArray",highlyStructuredMessage:"highlyStructured",sendPaymentMessage:"sendPayment",liveLocationMessage:"liveLocation",requestPaymentMessage:"requestPayment",declinePaymentRequestMessage:"declinePaymentRequest",cancelPaymentRequestMessage:"cancelPaymentRequest",templateMessage:"template",stickerMessage:"sticker",groupInviteMessage:"groupInvite",templateButtonReplyMessage:"templateButtonReply",productMessage:"product",deviceSentMessage:"deviceSent",listMessage:"list",viewOnceMessage:"viewOnce",orderMessage:"order",listResponseMessage:"listResponse",ephemeralMessage:"ephemeral",invoiceMessage:"invoice",buttonsMessage:"buttons",buttonsResponseMessage:"buttonsResponse",paymentInviteMessage:"paymentInvite",interactiveMessage:"interactive",reactionMessage:"reaction",stickerSyncRmrMessage:"stickerSyncRmr",interactiveResponseMessage:"interactiveResponse",pollCreationMessage:"pollCreation",pollUpdateMessage:"pollUpdate",keepInChatMessage:"keepInChat",documentWithCaptionMessage:"documentWithCaption",requestPhoneNumberMessage:"requestPhoneNumber",viewOnceMessageV2:"viewOnce",encReactionMessage:"encReaction",editedMessage:"edited",viewOnceMessageV2Extension:"viewOnce",pollCreationMessageV2:"pollCreation",scheduledCallCreationMessage:"scheduledCallCreation",groupMentionedMessage:"groupMentioned",pinInChatMessage:"pinInChat",pollCreationMessageV3:"pollCreation",scheduledCallEditMessage:"scheduledCallEdit",ptvMessage:"ptv",botInvokeMessage:"botInvoke",callLogMesssage:"callLog",encCommentMessage:"encComment",bcallMessage:"bcall",lottieStickerMessage:"lottieSticker",eventMessage:"event",commentMessage:"comment",newsletterAdminInviteMessage:"newsletterAdminInvite",extendedTextMessageWithParentKey:"text",placeholderMessage:"placeholder",encEventUpdateMessage:"encEventUpdate"};function y(e){if(e=x(e),console.log({obj:e}),typeof e!="object"||e===null)return[];for(let t of Object.keys(e))if(Object.keys(z).includes(t))return[z[t],t];for(let t of Object.values(e)){let s=y(t);if(s)return s}return[]}var A=h(require("cfonts")),j=h(require("chalk")),D=h(require("ora"));var $=require("events"),F=h(require("quick-lru")),V=new F.default({maxSize:9999999999}),M=new $.EventEmitter;function B(e){console.clear(),A.default.say("Zaileys",{font:"block",colors:["white","green"],letterSpacing:1,lineHeight:1,space:!1,maxLength:"0"}),A.default.say("         Love this package? help me with donation:         |               https://ko-fi.com/zaadevofc                 |",{font:"console",colors:["black"],background:"green",letterSpacing:1,space:!1,maxLength:"0"});let t=(0,D.default)();M.on("conn_msg",s=>{t[s[0]](s[1]),s[0]=="succeed"&&(V.set("conn_status",s[0]),M.on("conn_config",o=>{o?.forEach((n,a)=>{console.log(n)}),e.showLogs&&console.log(j.default`{cyan — Realtime Logs =>}\n`)}))}),e.showLogs&&M.on("act_msg",s=>{console.log({data:s})})}function E(e,t){return e.map((o,n)=>{console.log(d(o));let a=R(o.message,["contextInfo"]),i=c(o.message,["quotedMessage"])[0],l=o.key,f=c(o.message,["contextInfo"])[0],S=/\b\d+@\S+\b/g.exec(d(l))?.[0],T=/\b\d+@\S+\b/g.exec(d(f))?.[0],r=y(a);r=r[0]=="viewOnce"?y(c(a,[r[1]])):r;let u=y(i);u=u[0]=="viewOnce"?y(c(a,[u[1]])):u;let W=c(a,["conversation","text","caption","contentText","description"])[0],Q=c(i,["conversation","text","caption","contentText","description"])[0],k=r[0]!="text"&&c(a,[r[1]])[0];k=r[0]=="viewOnce"?c(k,y(k))[0]:k;let w=u[0]!="text"&&c(i,[u[1]])[0];return w=u[0]=="viewOnce"?c(w,y(w))[0]:w,{chatId:o.key.id,fromMe:o.key.fromMe,pushName:o.pushName,remoteJid:o.key.remoteJid,timestamp:o.messageTimestamp,body:{type:r[0],text:W,isGroup:d(l).includes("@g.us")??!1,isViewOnce:d(a).includes("viewOnce"),isBroadcast:o.broadcast,isAuthor:S,media:k},reply:i&&{type:u[0],text:Q,isGroup:d(f).includes("@g.us")??!1,isViewOnce:d(f).includes("viewOnce"),isAuthor:t.authors.includes(Number(T?.split("@")[0])),media:w}}})}var C="0.25.1-dev";var N=class{pairing;phoneNumber;showLogs;authors;socket=M;store;state;me;constructor({pairing:t,phoneNumber:s,showLogs:o,authors:n}){this.pairing=t??!0,this.phoneNumber=s,this.showLogs=o??!0,this.authors=n??[],this.client()}set saveState(t){this.state=t}async client(){B(this);let t=(0,m.makeInMemoryStore)({logger:(0,U.default)().child({level:"silent",stream:"store"})}),{state:s,saveCreds:o}=await(0,m.useMultiFileAuthState)("session/zaileys");t.readFromFile("session/data.json"),I(async()=>{try{t.writeToFile("session/data.json")}catch{await this.socket.emit("conn_msg",["fail",p.default.yellow("[DETECTED] session folder has been deleted by the user")]),await v(2e3),await this.socket.emit("conn_msg",["fail",p.default.yellow("Please rerun the program...")]),await process.exit()}},1e4),this.state=s,this.store=t;let n=(0,m.makeWASocket)(L(this));if(t.bind(n.ev),this.pairing&&this.phoneNumber&&!s.creds.me&&!n.authState.creds.registered){this.socket.emit("conn_msg",["start","Initialization new session..."]),await v(2e3),this.socket.emit("conn_msg",["start","Creating new pairing code..."]),await v(6e3);let i=await n.requestPairingCode(this.phoneNumber.toString());this.socket.emit("conn_msg",["info",`Connect with pairing code : ${p.default.green(i)}`])}n.ev.on("messages.upsert",async i=>{this.socket.emit("act_message",i.messages)});let a=await O("https://registry.npmjs.org/-/package/zaileys/dist-tags");return n.ev.process(async i=>{if(i["creds.update"]){let l=i["creds.update"];l&&a&&this.socket.emit("conn_config",[p.default`{greenBright → Login as       :} {redBright ${l.me?.verifiedName||l.me?.name}}`,p.default`{greenBright → Login Platform :} {cyanBright ${l.platform}}`,p.default`{greenBright → Creds Phone    :} {magentaBright ${l.phoneId}}`,p.default`{greenBright → Creds Device   :} {magentaBright ${l.deviceId}}`,p.default`{greenBright → Libs Current   :} {yellowBright zaileys-${C}}`,p.default`{greenBright → Libs Latest    :} {${a?.latest==C?"yellowBright":"magenta"} zaileys-${a?.latest}} {red ${a?.latest==C?"":"new version"}}`,""]),await o()}if(i["connection.update"]){let l=i["connection.update"],{connection:f,lastDisconnect:S,qr:T}=l;if(f=="connecting"&&(this.socket.emit("act_connection","connecting"),this.socket.emit("conn_msg",["start","Connecting to server..."])),T&&this.socket.emit("conn_msg",["warn","Please scan the QR code..."]),f==="close"){this.socket.emit("act_connection","close");let r=S?.error;if(r?.output.statusCode!==m.DisconnectReason.loggedOut&&(await this.socket.emit("conn_msg",["warn","Failed to connect. Waiting for reconnect..."]),await this.client()),r?.output.statusCode==m.DisconnectReason.connectionReplaced&&(await this.socket.emit("conn_msg",["fail",p.default`{redBright Connection was lost because the same session was in use!}`]),await process.exit(0)),r?.output.statusCode==m.DisconnectReason.loggedOut||r?.output.statusCode==m.DisconnectReason.badSession){this.socket.emit("conn_msg",["fail","Failed to connect. Please delete session and try again."]);return}await this.socket.emit("conn_msg",["info","Trying to reconnect..."]),await v(2e3),await this.socket.emit("conn_msg",["clear"])}f==="open"&&(this.socket.emit("act_connection","ready"),this.socket.emit("conn_msg",["succeed","Connected to server"]),console.log())}}),n}on(t,s){let o=(n,a)=>this.socket.on(`act_${n}`,a);switch(t){case"connection":o(t,n=>s(n));break;case"message":o(t,async n=>s(E(n,this)));break}}};0&&(module.exports={Client,ConnectionConfig,InitDisplay,MESSAGE_TYPE,MessageParser,delay,fetchJson,getMessageType,getValuesByKeys,jsonParse,jsonString,loop,postJson,removeKeys,timeout});
