var w=class{constructor({pairing:e,markOnline:o,phoneNumber:i,showLogs:n,authors:t,ignoreMe:m}){}sendText(){return"system"}sendReply(){}};import{DisconnectReason as Y,makeInMemoryStore as Z,makeWASocket as $,useMultiFileAuthState as X}from"baileys";import ee from"ora";import{makeCacheableSignalKeyStore as _,proto as j}from"baileys";import U from"node-cache";import R from"pino";var S={author:"https://github.com/zaadevofc",repository:"https://github.com/zaadevofc/zaileys",package:"https://www.npmjs.com/package/zaileys",homepage:"https://zaadevofc.github.io/zaileys/",version:[2,2413,1],browser:["Mac OS","chrome","121.0.6167.159"]};function z(s,e,o){async function i(n){return o?(await o.loadMessage(n.remoteJid,n.id))?.message||void 0:j.Message.fromObject({})}return{printQRInTerminal:!s.pairing,markOnlineOnConnect:!s.markOnline,defaultQueryTimeoutMs:0,connectTimeoutMs:6e4,keepAliveIntervalMs:1e4,msgRetryCounterCache:new U,syncFullHistory:!0,mobile:!1,generateHighQualityLinkPreview:!0,browser:S.browser,version:S.version,logger:R({enabled:!1}),auth:{creds:e.creds,keys:_(e.keys,R({enabled:!1}))},getMessage:i,patchMessageBeforeSending:n=>(!!(n.buttonsMessage||n.templateMessage||n.listMessage)&&(n={viewOnceMessage:{message:{messageContextInfo:{deviceListMetadataVersion:2,deviceListMetadata:{}},...n}}}),n)}}var O={text:"text",conversation:"text",imageMessage:"image",contactMessage:"contact",locationMessage:"location",extendedTextMessage:"text",documentMessage:"document",audioMessage:"audio",videoMessage:"video",protocolMessage:"protocol",contactsArrayMessage:"contactsArray",highlyStructuredMessage:"highlyStructured",sendPaymentMessage:"sendPayment",liveLocationMessage:"liveLocation",requestPaymentMessage:"requestPayment",declinePaymentRequestMessage:"declinePaymentRequest",cancelPaymentRequestMessage:"cancelPaymentRequest",templateMessage:"template",stickerMessage:"sticker",groupInviteMessage:"groupInvite",templateButtonReplyMessage:"templateButtonReply",productMessage:"product",deviceSentMessage:"deviceSent",listMessage:"list",viewOnceMessage:"viewOnce",orderMessage:"order",listResponseMessage:"listResponse",ephemeralMessage:"ephemeral",invoiceMessage:"invoice",buttonsMessage:"buttons",buttonsResponseMessage:"buttonsResponse",paymentInviteMessage:"paymentInvite",interactiveMessage:"interactive",reactionMessage:"reaction",stickerSyncRmrMessage:"sticker",interactiveResponseMessage:"interactiveResponse",pollCreationMessage:"pollCreation",pollUpdateMessage:"pollUpdate",keepInChatMessage:"keepInChat",documentWithCaptionMessage:"document",requestPhoneNumberMessage:"requestPhoneNumber",viewOnceMessageV2:"viewOnce",encReactionMessage:"reaction",editedMessage:"text",viewOnceMessageV2Extension:"viewOnce",pollCreationMessageV2:"pollCreation",scheduledCallCreationMessage:"scheduledCallCreation",groupMentionedMessage:"groupMentioned",pinInChatMessage:"pinInChat",pollCreationMessageV3:"pollCreation",scheduledCallEditMessage:"scheduledCallEdit",ptvMessage:"ptv",botInvokeMessage:"botInvoke",callLogMesssage:"callLog",encCommentMessage:"encComment",bcallMessage:"bcall",lottieStickerMessage:"lottieSticker",eventMessage:"event",commentMessage:"comment",newsletterAdminInviteMessage:"text",extendedTextMessageWithParentKey:"text",placeholderMessage:"placeholder",encEventUpdateMessage:"encEventUpdate"};function E(s,e){return setInterval(s,e)}function g(s){return JSON.stringify(s??{},null,2)}function N(s){return JSON.parse(g(s))}function ye(s,e){return setTimeout(s,e)}async function P(s){return new Promise(e=>setTimeout(e,s))}var ge=async(s,e)=>await fetch(s).then(o=>o.json()),he=async(s,e)=>await fetch(s,{body:JSON.stringify(e),method:"POST"}).then(o=>o.json());function a(s,e){let o=[],i=n=>{n!=null&&(Array.isArray(n)?n.forEach(i):typeof n=="object"&&Object.entries(n).forEach(([t,m])=>{e.includes(t)&&o.push(m),i(m)}))};return i(s),o}function C(s,e){let o=i=>{if(i===null||typeof i!="object")return i;if(Array.isArray(i))return i.map(o);let n={};for(let t in i)e.includes(t)||(n[t]=o(i[t]));return n};return o(N(s))}function r(s){if(s=N(s),typeof s!="object"||s===null)return[];for(let e of Object.keys(s))if(Object.keys(O).includes(e))return[O[e],e];for(let e of Object.values(s)){let o=r(e);if(o)return o}return[]}import q from"cfonts";import H from"ora";import{EventEmitter as D}from"events";import G from"quick-lru";var Ce=new G({maxSize:9999999999}),k=new D;var L="https://trakteer.id/zaadevofc";function J(s){console.clear(),q.say("Zaileys",{font:"block",colors:["white","green"],letterSpacing:1,lineHeight:1,space:!1,maxLength:"0"}),q.say(`         Love this package? help me with donation:         |               ${L}                 |`,{font:"console",colors:["black"],background:"green",letterSpacing:1,space:!1,maxLength:"0"});let e=H();k.on("conn_msg",async o=>{await e[o[0]](o[1])}),s.showLogs&&k.on("act_msg",o=>{})}async function W(s,e,o,i){return s?await Promise.all(s.map(async(t,m)=>{if(r(t.message).length==0||r(t.message)[0]=="protocol"||g(t.message).includes("pollUpdateMessage"))return;let c=C(t.message,["contextInfo"]),d=a(t.message,["quotedMessage"])[0],h=t.key,v=a(t.message,["contextInfo"])[0],b=r(c)[1]=="editedMessage",T=b&&a(t.message,["protocolMessage"])[0].key,x=b&&C(await o.loadMessage(T.remoteJid,T.id),["contextInfo"]);x=C(x.message,["contextInfo"]);let I=a(h,["participant"])[0]||a(h,["remoteJid"])[0],A=a(v,["participant"])[0],p=r(b?x:c);p=p[0]=="ephemeral"?r(a(c,[p[1]])):p,p=p[0]=="viewOnce"?r(a(c,[p[1]])):p;let l=r(d);l=l[0]=="ephemeral"?r(a(d,[l[1]])):l,l=l[0]=="viewOnce"?r(a(d,[l[1]])):l;let F=a(c,["conversation","text","caption","contentText","description"])[0],K=a(d,["conversation","text","caption","contentText","description"])[0],f=!["text","reaction"].includes(p[0])&&a(b?x:c,[p[1]=="documentWithCaptionMessage"?"documentMessage":p[1]])[0];f=p[0]=="ephemeral"?a(f,r(f))[0]:f,f=p[0]=="viewOnce"?a(f,r(f))[0]:f;let M=!["text","reaction"].includes(l[0])&&a(d,[l[1]=="documentWithCaptionMessage"?"documentMessage":l[1]])[0];return M=l[0]=="ephemeral"?a(M,r(M))[0]:M,M=l[0]=="viewOnce"?a(M,r(M))[0]:M,{body:{fromMe:t.key.fromMe,chatId:t.key.id,remoteJid:a(h,["remoteJid"])[0],participant:t.key.fromMe?i.creds.me?.id.replace(":74",""):I,pushName:t.key.fromMe?i.creds.me?.verifiedName||i.creds.me?.name:t.pushName,timestamp:t.messageTimestamp*1e3,type:p[0],text:F,isStory:g(h).includes("status@broadcast"),isGroup:g(h).includes("@g.us"),isViewOnce:g(c).includes("viewOnce"),isForwarded:g(t.message).includes("isForwarded"),isEdited:g(c).includes("editedMessage"),isBroadcast:t.broadcast,isAuthor:e.authors.includes(Number(I?.split("@")[0])),isEphemeral:a(t.message,["expiration"])[0]>0,media:f},reply:d?{chatId:a(v,["stanzaId"])[0],participant:A,type:l[0],text:K,isGroup:g(v).includes("@g.us"),isViewOnce:g(v).includes("viewOnce"),isForwarded:g(t.message).includes("isForwarded"),isAuthor:e.authors.includes(Number(A?.split("@")[0])),media:M}:!1}})):[]}var B=class extends w{pairing;markOnline;phoneNumber;showLogs;authors;ignoreMe;socket=k;socked={};spinners=ee();initialized=!1;initPromise=null;constructor({pairing:e,markOnline:o,phoneNumber:i,showLogs:n,authors:t,ignoreMe:m}){super({pairing:e,markOnline:o,phoneNumber:i,showLogs:n,authors:t,ignoreMe:m}),this.pairing=e??!0,this.markOnline=e??!0,this.phoneNumber=i,this.showLogs=n??!0,this.ignoreMe=m??!1,this.authors=t??[]}async init(){return this.initialized?this.initPromise:(this.initialized=!0,this.initPromise=(async()=>{J(this),this.spinners.start("Connecting to server...");let e=Z({}),{state:o,saveCreds:i}=await X("session/zaileys");E(async()=>{try{e.readFromFile("session/data.json"),e.writeToFile("session/data.json")}catch{await this.spinners.fail("Warning: Cannot detect session file"),await P(2e3),await this.spinners.info("Please rerun the program..."),await process.exit()}},1e4);let n=$(z(this,o,e));if(e.bind(n.ev),n.ev.on("creds.update",i),this.pairing&&this.phoneNumber&&!n.authState.creds.registered){this.spinners.text="Initialization new session...",await P(2e3),this.spinners.text="Creating new pairing code...",await P(6e3);try{let t=await n.requestPairingCode(this.phoneNumber.toString());this.spinners.info(`Connect with pairing code : ${t}`)}catch{this.spinners.fail("Connection close. Please delete session and run again..."),process.exit(0)}}return n.ev.on("connection.update",async t=>{let{connection:m,lastDisconnect:c,qr:d,isNewLogin:h}=t;m=="connecting"&&this.spinners.start("Connecting to server..."),!this.pairing&&d&&this.spinners.info("Scan this QR Code with your WhatsApp"),m==="close"?c?.error?.output?.statusCode!==Y.loggedOut?(this.spinners.info("Reconnecting to server..."),await this.init()):(this.spinners.fail("Detected logout. Please delete session and run again"),process.exit(0)):m==="open"&&(this.spinners.succeed("Successfully connected to server"),console.log())}),{sock:n,store:e,state:o}})(),this.initPromise)}async on(e,o){let{sock:i,store:n,state:t}=await this.init();this.socked={sock:i,store:n,state:t};let m=(c,d)=>this.socket.on(c,d);switch(e){case"connection":break;case"message":i.ev.on("messages.upsert",async c=>{let d=await W(c.messages,this,n,t);d.filter(h=>h).length!=0&&d.forEach(h=>{o(h)})});break}}async sendMsg(e,{jid:o}){await this.socked.sock?.sendMessage(o,{text:e})}};export{w as Actions,B as Client,z as ConnectionConfig,J as InitDisplay,O as MESSAGE_TYPE,W as MessageParser,P as delay,ge as fetchJson,r as getMessageType,a as getValuesByKeys,N as jsonParse,g as jsonString,E as loop,he as postJson,C as removeKeys,ye as timeout};
